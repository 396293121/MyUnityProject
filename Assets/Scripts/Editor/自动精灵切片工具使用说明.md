# Unity 自动精灵切片工具使用说明

## 概述

本工具包提供了两个Unity编辑器脚本，用于自动化处理精灵图的切片操作，避免手动在Sprite Editor中逐个设置的繁琐过程。

## 工具列表

### 1. AutoSpriteSliceTool.cs - 完整版工具
**功能特点：**
- 提供可视化窗口界面
- 支持高级参数配置
- 使用Unity内部API进行精确切片
- 支持批量处理和进度显示
- 提供详细的操作日志

### 2. SimpleSpriteSliceTool.cs - 简化版工具
**功能特点：**
- 轻量级实现，兼容性更好
- 支持反射调用和手动网格切片
- 自动检测合适的切片尺寸
- 适用于规则排列的精灵表

## 使用方法

### 方法一：使用右键菜单（推荐）

1. **选择精灵图**
   - 在Project窗口中选择一张或多张图片文件
   - 支持的格式：PNG, JPG, JPEG, TGA, PSD
   - 可以使用Shift或Ctrl进行多选

2. **执行自动切片**
   - 右键点击选中的图片
   - 选择 `Auto Slice Selected Sprites`（完整版）
   - 或选择 `Auto Slice Sprites (Simple)`（简化版）

3. **等待处理完成**
   - 工具会显示进度条
   - 处理完成后会显示结果统计

### 方法二：使用工具窗口（仅完整版）

1. **打开工具窗口**
   - 菜单栏选择 `Tools > Auto Sprite Slice Tool`

2. **配置参数**
   - 最小精灵尺寸：设置切片的最小像素大小
   - 精灵对齐方式：设置精灵的锚点位置

3. **添加精灵图**
   - 在Project窗口中选择图片
   - 点击"获取选中的精灵图"按钮

4. **执行切片**
   - 点击"执行自动切片"按钮
   - 查看处理结果

## 工具原理

### 自动切片算法

1. **Unity内部API调用**（优先）
   - 使用`SpriteUtility.GenerateAutomaticSpriteRectangles`
   - 基于透明度和颜色差异检测精灵边界
   - 提供最精确的切片结果

2. **网格切片算法**（备用）
   - 当内部API不可用时启用
   - 检测常见的精灵尺寸（16x16, 32x32, 64x64等）
   - 按规则网格进行切片

### 处理流程

```
选择图片文件
    ↓
验证文件格式
    ↓
设置TextureImporter属性
    ↓
执行自动切片算法
    ↓
应用切片数据
    ↓
保存并重新导入资源
```

## 配置说明

### TextureImporter设置

工具会自动配置以下属性：
- **Texture Type**: Sprite (2D and UI)
- **Sprite Mode**: Multiple
- **Filter Mode**: Point（适合像素艺术）
- **Compression**: Uncompressed（保持质量）
- **Pixels Per Unit**: 100

### 高级参数（完整版）

- **最小精灵尺寸**: 控制切片的最小像素大小，避免切出过小的碎片
- **精灵对齐方式**: 设置精灵的锚点位置，影响在场景中的定位

## 适用场景

### 理想使用场景

1. **角色动画精灵表**
   - 规则排列的动画帧
   - 每帧尺寸相同

2. **UI图标集合**
   - 多个图标排列在一张图上
   - 需要分别使用的UI元素

3. **瓦片地图素材**
   - 地形瓦片集合
   - 装饰物件集合

### 不适用场景

1. **不规则排列的精灵**
   - 大小不一的精灵混合排列
   - 需要手动精确调整边界

2. **单个大图**
   - 只包含一个精灵的图片
   - 背景图或完整插画

## 故障排除

### 常见问题

**Q: 工具无法识别选中的图片**
A: 确保选中的是图片文件（PNG、JPG等），而不是文件夹或其他资源

**Q: 切片结果不理想**
A: 
- 检查图片是否有透明背景
- 确保精灵之间有足够的间距
- 尝试调整最小精灵尺寸参数

**Q: 工具报错"无法访问Unity内部方法"**
A: 这是正常现象，工具会自动切换到备用的网格切片算法

**Q: 处理后精灵显示模糊**
A: 检查Filter Mode设置，像素艺术应使用Point模式

### 调试信息

工具会在Console窗口输出详细的处理日志：
- 成功处理的文件列表
- 失败的文件及原因
- 使用的切片算法类型
- 切片数量统计

## 性能优化

### 批量处理建议

1. **分批处理大量文件**
   - 建议每次处理不超过50张图片
   - 避免同时处理过大的图片文件

2. **关闭自动刷新**
   - 处理期间工具会自动管理资源刷新
   - 无需手动刷新Project窗口

3. **备份重要资源**
   - 处理前建议备份原始图片文件
   - 工具会修改导入设置，可能影响现有配置

## 扩展开发

### 自定义切片算法

可以通过修改代码添加自定义的切片逻辑：

```csharp
// 在AutoSliceSpriteAsset方法中添加自定义逻辑
private static bool CustomSliceAlgorithm(string assetPath, TextureImporter importer)
{
    // 实现自定义切片逻辑
    return true;
}
```

### 参数配置扩展

可以添加更多的配置参数：
- 切片命名规则
- 特定的像素单位设置
- 压缩质量选项
- 平台特定设置

## 版本兼容性

- **Unity 2019.4+**: 完全支持
- **Unity 2018.4+**: 支持简化版工具
- **Unity 2017.x**: 可能需要代码调整

## 更新日志

### v1.0
- 初始版本发布
- 支持基本的自动切片功能
- 提供完整版和简化版两个工具

---

**注意**: 使用工具前请备份重要的项目文件，工具会修改资源的导入设置。